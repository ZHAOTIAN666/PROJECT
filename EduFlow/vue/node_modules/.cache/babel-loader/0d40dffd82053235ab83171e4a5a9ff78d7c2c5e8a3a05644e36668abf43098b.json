{"ast":null,"code":"export default {\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      equipmentData: [],\n      descr: null,\n      fromVisible: false,\n      reserveVisible: false,\n      name: null,\n      start: null,\n      end: null,\n      equipmentId: null\n    };\n  },\n  mounted() {\n    this.loadEquipment();\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    loadEquipment() {\n      this.$request.get('/equipment/selectAll', {\n        params: {\n          name: this.name\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.equipmentData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    viewDescri(descr) {\n      this.descr = descr;\n      this.fromVisible = true;\n    },\n    reset() {\n      this.name = null;\n      this.loadEquipment();\n    },\n    reserveInit(equipmentId) {\n      if (this.user.role !== 'USER') {\n        this.$message.warning('您的角色暂不支持该操作');\n        return;\n      }\n      this.equipmentId = equipmentId;\n      this.start = null;\n      this.end = null;\n      this.reserveVisible = true;\n    },\n    submit() {\n      let data = {\n        userId: this.user.id,\n        equipmentId: this.equipmentId,\n        start: this.start,\n        end: this.end,\n        status: '待审核'\n      };\n      this.$request.post('/eqreserve/add', data).then(res => {\n        if (res.code === '200') {\n          this.$message.success('预约成功，等待管理员审核，您可以在器材预约里查看审核结果');\n          this.reserveVisible = false;\n          this.equipmentId = null;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["data","user","JSON","parse","localStorage","getItem","equipmentData","descr","fromVisible","reserveVisible","name","start","end","equipmentId","mounted","loadEquipment","methods","$request","get","params","then","res","code","$message","error","msg","viewDescri","reset","reserveInit","role","warning","submit","userId","id","status","post","success"],"sources":["src/views/front/Equipment.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\">\n    <div style=\"width: 80%; margin: 30px auto\">\n      <div style=\"text-align: center\">\n        <el-input placeholder=\"请输入器材名称查询\" style=\"width: 300px\" v-model=\"name\"></el-input>\n        <el-button type=\"primary\" plain style=\"margin-left: 10px\" @click=\"loadEquipment\">查询</el-button>\n        <el-button type=\"warning\" plain style=\"margin-left: 10px\" @click=\"reset\">重置</el-button>\n      </div>\n      <div style=\"margin-top: 30px\">\n        <el-row :gutter=\"30\">\n         <el-col :span=\"6\" v-for=\"item in equipmentData\" style=\"margin-bottom: 30px\">\n           <img :src=\"item.img\" alt=\"\" style=\"width: 100%; height: 280px; border-radius: 10px; cursor: pointer\">\n           <div style=\"font-size: 17px; margin-top: 10px; font-weight: bold; display: flex\">\n             <div style=\"flex: 1; color: #666666\">{{item.name}}</div>\n             <div style=\"text-align: right\">\n               <el-tag type=\"primary\" v-if=\"item.status === '空闲中'\">{{ item.status }}</el-tag>\n               <el-tag type=\"danger\" v-else>{{ item.status }}</el-tag>\n             </div>\n           </div>\n           <div style=\"margin-top: 10px; color: #666666; display: flex\">\n             <div style=\"flex: 1\">器材区域：{{ item.location }}</div>\n             <div style=\"flex: 1\">器材编号：{{ item.code }}</div>\n           </div>\n           <div style=\"margin-top: 15px\">\n             <el-button type=\"primary\" style=\"padding: 10px 30px\" @click=\"viewDescri(item.descr)\">使用说明</el-button>\n             <el-button type=\"info\" style=\"padding: 10px 30px\" :disabled=\"item.status === '使用中'\" @click=\"reserveInit(item.id)\">我要预约</el-button>\n           </div>\n         </el-col>\n        </el-row>\n      </div>\n    </div>\n    <el-dialog title=\"使用说明\" :visible.sync=\"fromVisible\" width=\"40%\" :close-on-click-modal=\"false\" destroy-on-close>\n      <el-form label-width=\"100px\" style=\"padding-right: 50px\">\n        {{descr}}\n      </el-form>\n    </el-dialog>\n    <el-dialog title=\"预约信息\" :visible.sync=\"reserveVisible\" width=\"40%\" :close-on-click-modal=\"false\" destroy-on-close>\n      <el-form label-width=\"100px\" style=\"padding-right: 50px\">\n        <el-form-item prop=\"start\" label=\"开始时间\">\n          <el-date-picker style=\"width: 100%\"\n              v-model=\"start\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"选择日期时间\">\n          </el-date-picker>\n        </el-form-item>\n        <el-form-item prop=\"end\" label=\"结束时间\">\n          <el-date-picker style=\"width: 100%\"\n              v-model=\"end\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"选择日期时间\">\n          </el-date-picker>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"reserveVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n\nexport default {\n\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      equipmentData: [],\n      descr: null,\n      fromVisible: false,\n      reserveVisible: false,\n      name: null,\n      start: null,\n      end: null,\n      equipmentId: null\n    }\n  },\n  mounted() {\n    this.loadEquipment()\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    loadEquipment() {\n      this.$request.get('/equipment/selectAll', {\n        params: {\n          name: this.name\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.equipmentData = res.data\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    },\n    viewDescri(descr) {\n      this.descr = descr\n      this.fromVisible = true\n    },\n    reset() {\n      this.name = null\n      this.loadEquipment()\n    },\n    reserveInit(equipmentId) {\n      if (this.user.role !== 'USER') {\n        this.$message.warning('您的角色暂不支持该操作')\n        return\n      }\n      this.equipmentId = equipmentId\n      this.start = null\n      this.end = null\n      this.reserveVisible = true\n    },\n    submit() {\n      let data = {\n        userId: this.user.id,\n        equipmentId: this.equipmentId,\n        start: this.start,\n        end: this.end,\n        status: '待审核'\n      }\n      this.$request.post('/eqreserve/add', data).then(res => {\n        if (res.code === '200') {\n          this.$message.success('预约成功，等待管理员审核，您可以在器材预约里查看审核结果')\n          this.reserveVisible = false\n          this.equipmentId = null\n        } else {\n          this.$message.error(res.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n"],"mappings":"AAiEA;EAEAA,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,aAAA;MACAC,KAAA;MACAC,WAAA;MACAC,cAAA;MACAC,IAAA;MACAC,KAAA;MACAC,GAAA;MACAC,WAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,aAAA;EACA;EACA;EACAC,OAAA;IACAD,cAAA;MACA,KAAAE,QAAA,CAAAC,GAAA;QACAC,MAAA;UACAT,IAAA,OAAAA;QACA;MACA,GAAAU,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAhB,aAAA,GAAAe,GAAA,CAAArB,IAAA;QACA;UACA,KAAAuB,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAC,WAAAnB,KAAA;MACA,KAAAA,KAAA,GAAAA,KAAA;MACA,KAAAC,WAAA;IACA;IACAmB,MAAA;MACA,KAAAjB,IAAA;MACA,KAAAK,aAAA;IACA;IACAa,YAAAf,WAAA;MACA,SAAAZ,IAAA,CAAA4B,IAAA;QACA,KAAAN,QAAA,CAAAO,OAAA;QACA;MACA;MACA,KAAAjB,WAAA,GAAAA,WAAA;MACA,KAAAF,KAAA;MACA,KAAAC,GAAA;MACA,KAAAH,cAAA;IACA;IACAsB,OAAA;MACA,IAAA/B,IAAA;QACAgC,MAAA,OAAA/B,IAAA,CAAAgC,EAAA;QACApB,WAAA,OAAAA,WAAA;QACAF,KAAA,OAAAA,KAAA;QACAC,GAAA,OAAAA,GAAA;QACAsB,MAAA;MACA;MACA,KAAAjB,QAAA,CAAAkB,IAAA,mBAAAnC,IAAA,EAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAa,OAAA;UACA,KAAA3B,cAAA;UACA,KAAAI,WAAA;QACA;UACA,KAAAU,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}