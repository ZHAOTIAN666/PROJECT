{"ast":null,"code":"export default {\n  name: 'ResourceList',\n  data() {\n    return {\n      user: {},\n      equipmentData: [],\n      descr: null,\n      fromVisible: false,\n      reserveVisible: false,\n      name: null,\n      start: null,\n      end: null,\n      equipmentId: null\n    };\n  },\n  mounted() {\n    this.initUser();\n    this.loadEquipment();\n  },\n  methods: {\n    // 安全地初始化用户数据\n    initUser() {\n      try {\n        const userStr = localStorage.getItem('xm-user');\n        this.user = userStr ? JSON.parse(userStr) : {};\n      } catch (error) {\n        console.error('Failed to parse user data:', error);\n        this.user = {};\n      }\n    },\n    loadEquipment() {\n      this.$request.get('/equipment/selectAll', {\n        params: {\n          name: this.name\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.equipmentData = res.data;\n        } else {\n          this.$message.error(res.msg || 'Failed to load resource data');\n        }\n      }).catch(error => {\n        console.error('Failed to load resources:', error);\n        this.$message.error('Failed to load resource data');\n      });\n    },\n    viewDescri(descr) {\n      this.descr = descr;\n      this.fromVisible = true;\n    },\n    reset() {\n      this.name = null;\n      this.loadEquipment();\n    },\n    reserveInit(equipmentId) {\n      if (this.user.role !== 'USER') {\n        this.$message.warning('Only students can make reservations');\n        return;\n      }\n      this.equipmentId = equipmentId;\n      this.start = null;\n      this.end = null;\n      this.reserveVisible = true;\n    },\n    submit() {\n      // 验证输入\n      if (!this.start || !this.end) {\n        this.$message.warning('Please select both start and end time');\n        return;\n      }\n      if (new Date(this.start) >= new Date(this.end)) {\n        this.$message.warning('End time must be after start time');\n        return;\n      }\n      const data = {\n        userId: this.user.id,\n        equipmentId: this.equipmentId,\n        start: this.start,\n        end: this.end,\n        status: '待审核'\n      };\n      this.$request.post('/eqreserve/add', data).then(res => {\n        if (res.code === '200') {\n          this.$message.success('Reservation successful! Waiting for admin approval. You can check the result in Resource Reservations.');\n          this.reserveVisible = false;\n          this.equipmentId = null;\n        } else {\n          this.$message.error(res.msg || 'Reservation failed');\n        }\n      }).catch(error => {\n        console.error('Reservation failed:', error);\n        this.$message.error('Reservation failed, please try again');\n      });\n    },\n    // 获取状态的英文文本\n    getStatusText(status) {\n      const statusMap = {\n        '空闲中': 'Available',\n        '使用中': 'In Use'\n      };\n      return statusMap[status] || status;\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","equipmentData","descr","fromVisible","reserveVisible","start","end","equipmentId","mounted","initUser","loadEquipment","methods","userStr","localStorage","getItem","JSON","parse","error","console","$request","get","params","then","res","code","$message","msg","catch","viewDescri","reset","reserveInit","role","warning","submit","Date","userId","id","status","post","success","getStatusText","statusMap"],"sources":["src/views/front/Equipment.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\">\n    <div class=\"container\">\n      <!-- Search Section -->\n      <div class=\"search-section\">\n        <div class=\"search-container\">\n          <el-input\n              placeholder=\"Enter resource name to search\"\n              class=\"search-input\"\n              v-model=\"name\"\n              clearable>\n            <i slot=\"prefix\" class=\"el-input__icon el-icon-search\"></i>\n          </el-input>\n          <el-button\n              type=\"primary\"\n              class=\"search-btn\"\n              @click=\"loadEquipment\"\n              icon=\"el-icon-search\">\n            Search\n          </el-button>\n          <el-button\n              type=\"warning\"\n              plain\n              class=\"reset-btn\"\n              @click=\"reset\"\n              icon=\"el-icon-refresh-left\">\n            Reset\n          </el-button>\n        </div>\n      </div>\n\n      <!-- Resource Grid Section -->\n      <div class=\"resource-grid\">\n        <el-row :gutter=\"30\">\n          <el-col :span=\"6\" v-for=\"item in equipmentData\" :key=\"item.id\" class=\"resource-col\">\n            <div class=\"resource-card\">\n              <!-- Resource Image -->\n              <div class=\"image-container\">\n                <img :src=\"item.img\" alt=\"Resource Image\" class=\"resource-image\">\n                <div class=\"status-overlay\">\n                  <el-tag\n                      :type=\"item.status === '空闲中' ? 'success' : 'danger'\"\n                      class=\"status-tag\">\n                    {{ getStatusText(item.status) }}\n                  </el-tag>\n                </div>\n              </div>\n\n              <!-- Resource Info -->\n              <div class=\"resource-info\">\n                <div class=\"resource-header\">\n                  <h3 class=\"resource-name\">{{ item.name }}</h3>\n                  <div class=\"resource-status\">\n                    <el-tag\n                        :type=\"item.status === '空闲中' ? 'success' : 'danger'\"\n                        size=\"small\">\n                      {{ getStatusText(item.status) }}\n                    </el-tag>\n                  </div>\n                </div>\n\n                <div class=\"resource-details\">\n                  <div class=\"detail-row\">\n                    <div class=\"detail-item\">\n                      <i class=\"el-icon-location-outline\"></i>\n                      <span class=\"detail-label\">Location:</span>\n                      <span class=\"detail-value\">{{ item.location }}</span>\n                    </div>\n                  </div>\n                  <div class=\"detail-row\">\n                    <div class=\"detail-item\">\n                      <i class=\"el-icon-tickets\"></i>\n                      <span class=\"detail-label\">Code:</span>\n                      <span class=\"detail-value\">{{ item.code }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"action-buttons\">\n                  <el-button\n                      type=\"primary\"\n                      size=\"small\"\n                      class=\"action-btn info-btn\"\n                      @click=\"viewDescri(item.descr)\"\n                      icon=\"el-icon-info\">\n                    Instructions\n                  </el-button>\n                  <el-button\n                      type=\"success\"\n                      size=\"small\"\n                      class=\"action-btn reserve-btn\"\n                      :disabled=\"item.status === '使用中'\"\n                      @click=\"reserveInit(item.id)\"\n                      icon=\"el-icon-date\">\n                    {{ item.status === '使用中' ? 'In Use' : 'Reserve' }}\n                  </el-button>\n                </div>\n              </div>\n            </div>\n          </el-col>\n        </el-row>\n\n        <!-- Empty State -->\n        <div v-if=\"equipmentData.length === 0\" class=\"empty-state\">\n          <i class=\"el-icon-folder-opened\"></i>\n          <p>No learning resources found</p>\n          <p class=\"empty-subtitle\">Try adjusting your search criteria</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Instructions Dialog -->\n    <el-dialog\n        title=\"Resource Instructions\"\n        :visible.sync=\"fromVisible\"\n        width=\"50%\"\n        :close-on-click-modal=\"false\"\n        destroy-on-close\n        class=\"custom-dialog\">\n      <div class=\"dialog-content\">\n        <div class=\"instruction-content\">\n          {{ descr }}\n        </div>\n      </div>\n    </el-dialog>\n\n    <!-- Reservation Dialog -->\n    <el-dialog\n        title=\"Resource Reservation\"\n        :visible.sync=\"reserveVisible\"\n        width=\"50%\"\n        :close-on-click-modal=\"false\"\n        destroy-on-close\n        class=\"custom-dialog\">\n      <el-form label-width=\"120px\" class=\"reservation-form\">\n        <el-form-item label=\"Start Time\" prop=\"start\" class=\"form-item\">\n          <el-date-picker\n              style=\"width: 100%\"\n              v-model=\"start\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"Select start date and time\"\n              class=\"custom-date-picker\">\n          </el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"End Time\" prop=\"end\" class=\"form-item\">\n          <el-date-picker\n              style=\"width: 100%\"\n              v-model=\"end\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"Select end date and time\"\n              class=\"custom-date-picker\">\n          </el-date-picker>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"reserveVisible = false\" class=\"cancel-btn\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"submit\" class=\"submit-btn\" icon=\"el-icon-check\">Confirm</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ResourceList',\n  data() {\n    return {\n      user: {},\n      equipmentData: [],\n      descr: null,\n      fromVisible: false,\n      reserveVisible: false,\n      name: null,\n      start: null,\n      end: null,\n      equipmentId: null\n    }\n  },\n  mounted() {\n    this.initUser()\n    this.loadEquipment()\n  },\n  methods: {\n    // 安全地初始化用户数据\n    initUser() {\n      try {\n        const userStr = localStorage.getItem('xm-user')\n        this.user = userStr ? JSON.parse(userStr) : {}\n      } catch (error) {\n        console.error('Failed to parse user data:', error)\n        this.user = {}\n      }\n    },\n\n    loadEquipment() {\n      this.$request.get('/equipment/selectAll', {\n        params: {\n          name: this.name\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.equipmentData = res.data\n        } else {\n          this.$message.error(res.msg || 'Failed to load resource data')\n        }\n      }).catch(error => {\n        console.error('Failed to load resources:', error)\n        this.$message.error('Failed to load resource data')\n      })\n    },\n\n    viewDescri(descr) {\n      this.descr = descr\n      this.fromVisible = true\n    },\n\n    reset() {\n      this.name = null\n      this.loadEquipment()\n    },\n\n    reserveInit(equipmentId) {\n      if (this.user.role !== 'USER') {\n        this.$message.warning('Only students can make reservations')\n        return\n      }\n      this.equipmentId = equipmentId\n      this.start = null\n      this.end = null\n      this.reserveVisible = true\n    },\n\n    submit() {\n      // 验证输入\n      if (!this.start || !this.end) {\n        this.$message.warning('Please select both start and end time')\n        return\n      }\n\n      if (new Date(this.start) >= new Date(this.end)) {\n        this.$message.warning('End time must be after start time')\n        return\n      }\n\n      const data = {\n        userId: this.user.id,\n        equipmentId: this.equipmentId,\n        start: this.start,\n        end: this.end,\n        status: '待审核'\n      }\n\n      this.$request.post('/eqreserve/add', data).then(res => {\n        if (res.code === '200') {\n          this.$message.success('Reservation successful! Waiting for admin approval. You can check the result in Resource Reservations.')\n          this.reserveVisible = false\n          this.equipmentId = null\n        } else {\n          this.$message.error(res.msg || 'Reservation failed')\n        }\n      }).catch(error => {\n        console.error('Reservation failed:', error)\n        this.$message.error('Reservation failed, please try again')\n      })\n    },\n\n    // 获取状态的英文文本\n    getStatusText(status) {\n      const statusMap = {\n        '空闲中': 'Available',\n        '使用中': 'In Use'\n      }\n      return statusMap[status] || status\n    }\n  }\n}\n</script>\n\n<style scoped>\n.main-content {\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  min-height: 100vh;\n  padding: 40px 0;\n}\n\n.container {\n  width: 85%;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n/* Search Section */\n.search-section {\n  background: white;\n  border-radius: 16px;\n  padding: 30px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n  margin-bottom: 40px;\n}\n\n.search-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 15px;\n}\n\n.search-input {\n  width: 350px;\n}\n\n.search-input /deep/ .el-input__inner {\n  border-radius: 25px;\n  height: 45px;\n  border: 2px solid #e2e8f0;\n  transition: all 0.3s ease;\n}\n\n.search-input /deep/ .el-input__inner:focus {\n  border-color: #6366f1;\n  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.search-btn {\n  height: 45px;\n  padding: 0 25px;\n  border-radius: 25px;\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  border: none;\n  font-weight: 600;\n  transition: all 0.3s ease;\n}\n\n.search-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);\n}\n\n.reset-btn {\n  height: 45px;\n  padding: 0 25px;\n  border-radius: 25px;\n  border: 2px solid #f59e0b;\n  color: #f59e0b;\n  font-weight: 600;\n  transition: all 0.3s ease;\n}\n\n.reset-btn:hover {\n  background: #f59e0b;\n  color: white;\n  transform: translateY(-2px);\n}\n\n/* Resource Grid */\n.resource-grid {\n  margin-top: 40px;\n}\n\n.resource-col {\n  margin-bottom: 40px;\n}\n\n.resource-card {\n  background: white;\n  border-radius: 20px;\n  overflow: hidden;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);\n  transition: all 0.4s ease;\n  height: 100%;\n}\n\n.resource-card:hover {\n  transform: translateY(-10px);\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);\n}\n\n/* Image Container */\n.image-container {\n  position: relative;\n  overflow: hidden;\n  height: 280px;\n}\n\n.resource-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transition: all 0.4s ease;\n}\n\n.resource-card:hover .resource-image {\n  transform: scale(1.05);\n}\n\n.status-overlay {\n  position: absolute;\n  top: 15px;\n  right: 15px;\n}\n\n.status-tag {\n  font-weight: 600;\n  padding: 8px 16px;\n  border-radius: 20px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n/* Resource Info */\n.resource-info {\n  padding: 25px;\n}\n\n.resource-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 20px;\n}\n\n.resource-name {\n  flex: 1;\n  font-size: 18px;\n  font-weight: 700;\n  color: #2d3748;\n  margin: 0;\n  line-height: 1.4;\n}\n\n.resource-status {\n  margin-left: 15px;\n}\n\n.resource-details {\n  margin-bottom: 25px;\n}\n\n.detail-row {\n  margin-bottom: 12px;\n}\n\n.detail-item {\n  display: flex;\n  align-items: center;\n  color: #718096;\n  font-size: 14px;\n}\n\n.detail-item i {\n  margin-right: 8px;\n  color: #6366f1;\n  font-size: 16px;\n  width: 18px;\n}\n\n.detail-label {\n  font-weight: 600;\n  margin-right: 8px;\n}\n\n.detail-value {\n  color: #4a5568;\n}\n\n.action-buttons {\n  display: flex;\n  gap: 10px;\n}\n\n.action-btn {\n  flex: 1;\n  border-radius: 20px;\n  font-weight: 600;\n  transition: all 0.3s ease;\n}\n\n.info-btn {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  border: none;\n}\n\n.reserve-btn {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  border: none;\n}\n\n.action-btn:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);\n}\n\n/* Empty State */\n.empty-state {\n  text-align: center;\n  padding: 80px 20px;\n  color: #a0aec0;\n}\n\n.empty-state i {\n  font-size: 80px;\n  margin-bottom: 20px;\n  display: block;\n}\n\n.empty-state p {\n  font-size: 18px;\n  margin-bottom: 8px;\n  color: #718096;\n}\n\n.empty-subtitle {\n  font-size: 14px;\n  color: #a0aec0;\n}\n\n/* Dialog Styles */\n.custom-dialog /deep/ .el-dialog {\n  border-radius: 16px;\n  overflow: hidden;\n}\n\n.custom-dialog /deep/ .el-dialog__header {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  color: white;\n  padding: 20px 30px;\n}\n\n.custom-dialog /deep/ .el-dialog__title {\n  color: white;\n  font-weight: 600;\n  font-size: 18px;\n}\n\n.custom-dialog /deep/ .el-dialog__headerbtn .el-dialog__close {\n  color: white;\n  font-size: 20px;\n}\n\n.custom-dialog /deep/ .el-dialog__body {\n  padding: 30px;\n}\n\n.dialog-content {\n  padding: 0;\n}\n\n.instruction-content {\n  background: #f8f9fc;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 20px;\n  line-height: 1.6;\n  color: #4a5568;\n  font-size: 16px;\n}\n\n.reservation-form {\n  padding: 0;\n}\n\n.form-item {\n  margin-bottom: 25px;\n}\n\n.custom-date-picker /deep/ .el-input__inner {\n  border-radius: 8px;\n  height: 40px;\n}\n\n.dialog-footer {\n  text-align: right;\n  padding: 20px 0 0 0;\n  border-top: 1px solid #e2e8f0;\n}\n\n.cancel-btn {\n  border-radius: 20px;\n  padding: 10px 25px;\n}\n\n.submit-btn {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  border: none;\n  border-radius: 20px;\n  padding: 10px 25px;\n  font-weight: 600;\n}\n\n/* Responsive Design */\n@media (max-width: 1200px) {\n  .resource-col {\n    width: 33.333333%;\n  }\n}\n\n@media (max-width: 992px) {\n  .container {\n    width: 95%;\n  }\n\n  .search-container {\n    flex-direction: column;\n    gap: 15px;\n  }\n\n  .search-input {\n    width: 100%;\n    max-width: 400px;\n  }\n\n  .resource-col {\n    width: 50%;\n  }\n}\n\n@media (max-width: 768px) {\n  .main-content {\n    padding: 20px 0;\n  }\n\n  .search-section {\n    padding: 20px;\n    margin-bottom: 30px;\n  }\n\n  .resource-col {\n    width: 100%;\n  }\n\n  .resource-header {\n    flex-direction: column;\n    gap: 15px;\n  }\n\n  .resource-status {\n    margin-left: 0;\n    align-self: flex-start;\n  }\n\n  .action-buttons {\n    flex-direction: column;\n  }\n\n  .custom-dialog /deep/ .el-dialog {\n    width: 95% !important;\n  }\n}\n\n@media (max-width: 576px) {\n  .search-btn,\n  .reset-btn {\n    width: 100%;\n    max-width: 200px;\n  }\n}\n</style>"],"mappings":"AAqKA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA;MACAC,aAAA;MACAC,KAAA;MACAC,WAAA;MACAC,cAAA;MACAN,IAAA;MACAO,KAAA;MACAC,GAAA;MACAC,WAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,QAAA;IACA,KAAAC,aAAA;EACA;EACAC,OAAA;IACA;IACAF,SAAA;MACA;QACA,MAAAG,OAAA,GAAAC,YAAA,CAAAC,OAAA;QACA,KAAAd,IAAA,GAAAY,OAAA,GAAAG,IAAA,CAAAC,KAAA,CAAAJ,OAAA;MACA,SAAAK,KAAA;QACAC,OAAA,CAAAD,KAAA,+BAAAA,KAAA;QACA,KAAAjB,IAAA;MACA;IACA;IAEAU,cAAA;MACA,KAAAS,QAAA,CAAAC,GAAA;QACAC,MAAA;UACAvB,IAAA,OAAAA;QACA;MACA,GAAAwB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAvB,aAAA,GAAAsB,GAAA,CAAAxB,IAAA;QACA;UACA,KAAA0B,QAAA,CAAAR,KAAA,CAAAM,GAAA,CAAAG,GAAA;QACA;MACA,GAAAC,KAAA,CAAAV,KAAA;QACAC,OAAA,CAAAD,KAAA,8BAAAA,KAAA;QACA,KAAAQ,QAAA,CAAAR,KAAA;MACA;IACA;IAEAW,WAAA1B,KAAA;MACA,KAAAA,KAAA,GAAAA,KAAA;MACA,KAAAC,WAAA;IACA;IAEA0B,MAAA;MACA,KAAA/B,IAAA;MACA,KAAAY,aAAA;IACA;IAEAoB,YAAAvB,WAAA;MACA,SAAAP,IAAA,CAAA+B,IAAA;QACA,KAAAN,QAAA,CAAAO,OAAA;QACA;MACA;MACA,KAAAzB,WAAA,GAAAA,WAAA;MACA,KAAAF,KAAA;MACA,KAAAC,GAAA;MACA,KAAAF,cAAA;IACA;IAEA6B,OAAA;MACA;MACA,UAAA5B,KAAA,UAAAC,GAAA;QACA,KAAAmB,QAAA,CAAAO,OAAA;QACA;MACA;MAEA,QAAAE,IAAA,MAAA7B,KAAA,SAAA6B,IAAA,MAAA5B,GAAA;QACA,KAAAmB,QAAA,CAAAO,OAAA;QACA;MACA;MAEA,MAAAjC,IAAA;QACAoC,MAAA,OAAAnC,IAAA,CAAAoC,EAAA;QACA7B,WAAA,OAAAA,WAAA;QACAF,KAAA,OAAAA,KAAA;QACAC,GAAA,OAAAA,GAAA;QACA+B,MAAA;MACA;MAEA,KAAAlB,QAAA,CAAAmB,IAAA,mBAAAvC,IAAA,EAAAuB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAc,OAAA;UACA,KAAAnC,cAAA;UACA,KAAAG,WAAA;QACA;UACA,KAAAkB,QAAA,CAAAR,KAAA,CAAAM,GAAA,CAAAG,GAAA;QACA;MACA,GAAAC,KAAA,CAAAV,KAAA;QACAC,OAAA,CAAAD,KAAA,wBAAAA,KAAA;QACA,KAAAQ,QAAA,CAAAR,KAAA;MACA;IACA;IAEA;IACAuB,cAAAH,MAAA;MACA,MAAAI,SAAA;QACA;QACA;MACA;MACA,OAAAA,SAAA,CAAAJ,MAAA,KAAAA,MAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}