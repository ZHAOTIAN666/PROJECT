{"ast":null,"code":"export default {\n  name: 'ResourceReservations',\n  data() {\n    return {\n      user: {},\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0\n    };\n  },\n  mounted() {\n    this.initUser();\n    this.load(1);\n  },\n  methods: {\n    // 初始化用户信息\n    initUser() {\n      try {\n        const userStr = localStorage.getItem('xm-user');\n        this.user = userStr ? JSON.parse(userStr) : {};\n      } catch (error) {\n        console.error('Failed to parse user data from localStorage:', error);\n        this.user = {};\n      }\n    },\n    load(pageNum) {\n      if (pageNum) this.pageNum = pageNum;\n\n      // 检查是否有用户ID\n      if (!this.user.id) {\n        this.$message.warning('User information not found, please login again');\n        return;\n      }\n      this.$request.get('/eqreserve/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          userId: this.user.id\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data?.list || [];\n          this.total = res.data?.total || 0;\n        } else {\n          this.$message.error(res.msg || 'Failed to load data');\n        }\n      }).catch(error => {\n        console.error('Failed to load reservations:', error);\n        this.$message.error('Failed to load reservation data');\n      });\n    },\n    del(id) {\n      this.$confirm('Are you sure you want to cancel this reservation?', 'Confirm Cancellation', {\n        type: \"warning\",\n        confirmButtonText: 'Yes, Cancel',\n        cancelButtonText: 'No, Keep'\n      }).then(() => {\n        this.$request.delete('/eqreserve/delete/' + id).then(res => {\n          if (res.code === '200') {\n            this.$message.success('Reservation cancelled successfully');\n            this.load(1);\n          } else {\n            this.$message.error(res.msg || 'Failed to cancel reservation');\n          }\n        }).catch(error => {\n          console.error('Failed to delete reservation:', error);\n          this.$message.error('Failed to cancel reservation');\n        });\n      }).catch(() => {\n        // 用户取消操作\n      });\n    },\n    handleCurrentChange(pageNum) {\n      this.load(pageNum);\n    },\n    // 获取状态对应的标签类型\n    getStatusType(status) {\n      const statusMap = {\n        '待审核': 'warning',\n        '已通过': 'success',\n        '已拒绝': 'danger',\n        '已完成': 'info'\n      };\n      return statusMap[status] || 'info';\n    },\n    // 获取状态的英文文本\n    getStatusText(status) {\n      const statusMap = {\n        '待审核': 'Pending',\n        '已通过': 'Approved',\n        '已拒绝': 'Rejected',\n        '已完成': 'Completed'\n      };\n      return statusMap[status] || status;\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","tableData","pageNum","pageSize","total","mounted","initUser","load","methods","userStr","localStorage","getItem","JSON","parse","error","console","id","$message","warning","$request","get","params","userId","then","res","code","list","msg","catch","del","$confirm","type","confirmButtonText","cancelButtonText","delete","success","handleCurrentChange","getStatusType","status","statusMap","getStatusText"],"sources":["src/views/front/EqReserve.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\">\n    <div class=\"container\">\n      <!-- 页面标题 -->\n      <div class=\"page-header\">\n        <h2 class=\"page-title\">My Learning Resource Reservations</h2>\n        <div class=\"total-count\">Total: {{total}} records</div>\n      </div>\n\n      <!-- 表格容器 -->\n      <div class=\"table-container\">\n        <el-table :data=\"tableData\" stripe class=\"custom-table\" empty-text=\"No reservation records found\">\n          <el-table-column prop=\"id\" label=\"ID\" width=\"80\" align=\"center\" sortable>\n            <template slot-scope=\"scope\">\n              <span class=\"id-badge\">#{{scope.row.id}}</span>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"equipmentImg\" label=\"Resource Image\" width=\"120\" align=\"center\">\n            <template slot-scope=\"scope\">\n              <div class=\"image-container\">\n                <el-image\n                    class=\"resource-image\"\n                    v-if=\"scope.row.equipmentImg\"\n                    :src=\"scope.row.equipmentImg\"\n                    :preview-src-list=\"[scope.row.equipmentImg]\"\n                    fit=\"cover\">\n                  <div slot=\"error\" class=\"image-slot\">\n                    <i class=\"el-icon-picture-outline\"></i>\n                  </div>\n                </el-image>\n                <div v-else class=\"no-image\">\n                  <i class=\"el-icon-picture-outline\"></i>\n                </div>\n              </div>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"equipmentName\" label=\"Resource Name\" show-overflow-tooltip min-width=\"150\">\n            <template slot-scope=\"scope\">\n              <span class=\"resource-name\">{{scope.row.equipmentName}}</span>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"start\" label=\"Start Time\" show-overflow-tooltip min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <div class=\"time-info\">\n                <i class=\"el-icon-time\"></i>\n                <span>{{scope.row.start}}</span>\n              </div>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"end\" label=\"End Time\" show-overflow-tooltip min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <div class=\"time-info\">\n                <i class=\"el-icon-time\"></i>\n                <span>{{scope.row.end}}</span>\n              </div>\n            </template>\n          </el-table-column>\n\n          <el-table-column prop=\"status\" label=\"Status\" width=\"120\" align=\"center\">\n            <template slot-scope=\"scope\">\n              <el-tag\n                  :type=\"getStatusType(scope.row.status)\"\n                  size=\"small\"\n                  class=\"status-tag\">\n                {{getStatusText(scope.row.status)}}\n              </el-tag>\n            </template>\n          </el-table-column>\n\n          <el-table-column label=\"Actions\" width=\"150\" align=\"center\" v-if=\"user.role === 'USER'\">\n            <template slot-scope=\"scope\">\n              <el-button\n                  type=\"danger\"\n                  size=\"mini\"\n                  icon=\"el-icon-delete\"\n                  @click=\"del(scope.row.id)\"\n                  :disabled=\"scope.row.status !== '待审核'\"\n                  class=\"action-btn\">\n                Cancel\n              </el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n\n        <!-- 分页组件 -->\n        <div class=\"pagination-container\">\n          <el-pagination\n              background\n              @current-change=\"handleCurrentChange\"\n              :current-page=\"pageNum\"\n              :page-sizes=\"[5, 10, 20]\"\n              :page-size=\"pageSize\"\n              layout=\"total, prev, pager, next\"\n              :total=\"total\"\n              class=\"custom-pagination\">\n          </el-pagination>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ResourceReservations',\n  data() {\n    return {\n      user: {},\n      tableData: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n    }\n  },\n  mounted() {\n    this.initUser()\n    this.load(1)\n  },\n  methods: {\n    // 初始化用户信息\n    initUser() {\n      try {\n        const userStr = localStorage.getItem('xm-user')\n        this.user = userStr ? JSON.parse(userStr) : {}\n      } catch (error) {\n        console.error('Failed to parse user data from localStorage:', error)\n        this.user = {}\n      }\n    },\n\n    load(pageNum) {\n      if (pageNum) this.pageNum = pageNum\n\n      // 检查是否有用户ID\n      if (!this.user.id) {\n        this.$message.warning('User information not found, please login again')\n        return\n      }\n\n      this.$request.get('/eqreserve/selectPage', {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          userId: this.user.id\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data?.list || []\n          this.total = res.data?.total || 0\n        } else {\n          this.$message.error(res.msg || 'Failed to load data')\n        }\n      }).catch(error => {\n        console.error('Failed to load reservations:', error)\n        this.$message.error('Failed to load reservation data')\n      })\n    },\n\n    del(id) {\n      this.$confirm('Are you sure you want to cancel this reservation?', 'Confirm Cancellation', {\n        type: \"warning\",\n        confirmButtonText: 'Yes, Cancel',\n        cancelButtonText: 'No, Keep'\n      }).then(() => {\n        this.$request.delete('/eqreserve/delete/' + id).then(res => {\n          if (res.code === '200') {\n            this.$message.success('Reservation cancelled successfully')\n            this.load(1)\n          } else {\n            this.$message.error(res.msg || 'Failed to cancel reservation')\n          }\n        }).catch(error => {\n          console.error('Failed to delete reservation:', error)\n          this.$message.error('Failed to cancel reservation')\n        })\n      }).catch(() => {\n        // 用户取消操作\n      })\n    },\n\n    handleCurrentChange(pageNum) {\n      this.load(pageNum)\n    },\n\n    // 获取状态对应的标签类型\n    getStatusType(status) {\n      const statusMap = {\n        '待审核': 'warning',\n        '已通过': 'success',\n        '已拒绝': 'danger',\n        '已完成': 'info'\n      }\n      return statusMap[status] || 'info'\n    },\n\n    // 获取状态的英文文本\n    getStatusText(status) {\n      const statusMap = {\n        '待审核': 'Pending',\n        '已通过': 'Approved',\n        '已拒绝': 'Rejected',\n        '已完成': 'Completed'\n      }\n      return statusMap[status] || status\n    }\n  }\n}\n</script>\n\n<style scoped>\n.main-content {\n  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n  min-height: 100vh;\n  padding: 20px 0;\n}\n\n.container {\n  width: 90%;\n  max-width: 1200px;\n  margin: 0 auto;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.page-header {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  color: white;\n  padding: 30px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.page-title {\n  margin: 0;\n  font-size: 28px;\n  font-weight: 600;\n  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.total-count {\n  background: rgba(255, 255, 255, 0.2);\n  padding: 8px 16px;\n  border-radius: 20px;\n  font-size: 14px;\n  backdrop-filter: blur(10px);\n}\n\n.table-container {\n  padding: 30px;\n}\n\n.custom-table {\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n}\n\n.custom-table /deep/ .el-table__header {\n  background: #f8f9fc;\n}\n\n.custom-table /deep/ .el-table__header th {\n  background: #f8f9fc !important;\n  color: #2d3748;\n  font-weight: 600;\n  border-bottom: 2px solid #e2e8f0;\n  padding: 16px 12px;\n}\n\n.custom-table /deep/ .el-table__row:hover {\n  background: #f7fafc !important;\n}\n\n.custom-table /deep/ .el-table__row td {\n  padding: 16px 12px;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.id-badge {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  color: white;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 600;\n}\n\n.image-container {\n  display: flex;\n  justify-content: center;\n}\n\n.resource-image {\n  width: 50px;\n  height: 50px;\n  border-radius: 8px;\n  border: 2px solid #e2e8f0;\n  transition: all 0.3s ease;\n}\n\n.resource-image:hover {\n  transform: scale(1.1);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.no-image {\n  width: 50px;\n  height: 50px;\n  background: #f7fafc;\n  border: 2px dashed #cbd5e0;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #a0aec0;\n}\n\n.image-slot {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  background: #f5f5f5;\n  color: #909399;\n}\n\n.resource-name {\n  font-weight: 500;\n  color: #2d3748;\n}\n\n.time-info {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  color: #4a5568;\n}\n\n.time-info i {\n  color: #6366f1;\n}\n\n.status-tag {\n  font-weight: 500;\n  border: none;\n  padding: 6px 12px;\n}\n\n.action-btn {\n  transition: all 0.3s ease;\n}\n\n.action-btn:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(245, 101, 101, 0.3);\n}\n\n.pagination-container {\n  display: flex;\n  justify-content: center;\n  margin-top: 30px;\n  padding-top: 20px;\n  border-top: 1px solid #e2e8f0;\n}\n\n.custom-pagination /deep/ .el-pagination {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.custom-pagination /deep/ .el-pager li {\n  border-radius: 6px;\n  margin: 0 2px;\n  transition: all 0.3s ease;\n}\n\n.custom-pagination /deep/ .el-pager li.active {\n  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n  color: white;\n}\n\n.custom-pagination /deep/ .btn-prev,\n.custom-pagination /deep/ .btn-next {\n  border-radius: 6px;\n  transition: all 0.3s ease;\n}\n\n.custom-pagination /deep/ .btn-prev:hover,\n.custom-pagination /deep/ .btn-next:hover {\n  background: #6366f1;\n  color: white;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .container {\n    width: 95%;\n    margin: 10px auto;\n  }\n\n  .page-header {\n    padding: 20px;\n    flex-direction: column;\n    gap: 10px;\n    text-align: center;\n  }\n\n  .page-title {\n    font-size: 24px;\n  }\n\n  .table-container {\n    padding: 20px;\n  }\n}\n</style>"],"mappings":"AA2GA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA;MACAC,SAAA;MACAC,OAAA;MACAC,QAAA;MACAC,KAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACA;IACAF,SAAA;MACA;QACA,MAAAG,OAAA,GAAAC,YAAA,CAAAC,OAAA;QACA,KAAAX,IAAA,GAAAS,OAAA,GAAAG,IAAA,CAAAC,KAAA,CAAAJ,OAAA;MACA,SAAAK,KAAA;QACAC,OAAA,CAAAD,KAAA,iDAAAA,KAAA;QACA,KAAAd,IAAA;MACA;IACA;IAEAO,KAAAL,OAAA;MACA,IAAAA,OAAA,OAAAA,OAAA,GAAAA,OAAA;;MAEA;MACA,UAAAF,IAAA,CAAAgB,EAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;QACA;MACA;MAEA,KAAAC,QAAA,CAAAC,GAAA;QACAC,MAAA;UACAnB,OAAA,OAAAA,OAAA;UACAC,QAAA,OAAAA,QAAA;UACAmB,MAAA,OAAAtB,IAAA,CAAAgB;QACA;MACA,GAAAO,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAxB,SAAA,GAAAuB,GAAA,CAAAzB,IAAA,EAAA2B,IAAA;UACA,KAAAtB,KAAA,GAAAoB,GAAA,CAAAzB,IAAA,EAAAK,KAAA;QACA;UACA,KAAAa,QAAA,CAAAH,KAAA,CAAAU,GAAA,CAAAG,GAAA;QACA;MACA,GAAAC,KAAA,CAAAd,KAAA;QACAC,OAAA,CAAAD,KAAA,iCAAAA,KAAA;QACA,KAAAG,QAAA,CAAAH,KAAA;MACA;IACA;IAEAe,IAAAb,EAAA;MACA,KAAAc,QAAA;QACAC,IAAA;QACAC,iBAAA;QACAC,gBAAA;MACA,GAAAV,IAAA;QACA,KAAAJ,QAAA,CAAAe,MAAA,wBAAAlB,EAAA,EAAAO,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAAC,IAAA;YACA,KAAAR,QAAA,CAAAkB,OAAA;YACA,KAAA5B,IAAA;UACA;YACA,KAAAU,QAAA,CAAAH,KAAA,CAAAU,GAAA,CAAAG,GAAA;UACA;QACA,GAAAC,KAAA,CAAAd,KAAA;UACAC,OAAA,CAAAD,KAAA,kCAAAA,KAAA;UACA,KAAAG,QAAA,CAAAH,KAAA;QACA;MACA,GAAAc,KAAA;QACA;MAAA,CACA;IACA;IAEAQ,oBAAAlC,OAAA;MACA,KAAAK,IAAA,CAAAL,OAAA;IACA;IAEA;IACAmC,cAAAC,MAAA;MACA,MAAAC,SAAA;QACA;QACA;QACA;QACA;MACA;MACA,OAAAA,SAAA,CAAAD,MAAA;IACA;IAEA;IACAE,cAAAF,MAAA;MACA,MAAAC,SAAA;QACA;QACA;QACA;QACA;MACA;MACA,OAAAA,SAAA,CAAAD,MAAA,KAAAA,MAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}